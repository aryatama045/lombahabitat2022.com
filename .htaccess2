RewriteEngine On

RewriteCond %{HTTPS} Off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
RewriteCond %{REQUEST_URI} !^/\.well-known/acme-challenge/[0-9a-zA-Z_-]+$
RewriteCond %{REQUEST_URI} !^/\.well-known/cpanel-dcv/[0-9a-zA-Z_-]+$
RewriteCond %{REQUEST_URI} !^/\.well-known/pki-validation/98B3D55C243E17A43A8106136A1468D6.txt

RewriteCond %{REQUEST_URI} ^/system.*
RewriteRule ^(.*)$ index.php?/$1 [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+)$ index.php?/$1 [L]
RewriteCond %{REQUEST_URI} !^/\.well-known/pki-validation/
#RewriteCond %{REQUEST_URI} !maintenance.html
#RewriteCond %{REQUEST_FILENAME} !(styles|images).+$
#RewriteCond %{REMOTE_ADDR} !^144\.4\.78\.177$
#RewriteCond %{REMOTE_ADDR} !^127\.0\.0\.1$
#RewriteRule (.*) /maintenance.html [R,L]